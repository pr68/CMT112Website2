<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ==" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin=""></script>
  <title>Lake District</title>
</head>

<body>
  <header>
    <h1>Lake District</h1>
    <h2>Location</h2>
  </header>
  <nav>
    <a href="location.html" class="navbox">Location</a>
    <a href="lakes.html" class="navbox">Lakes</a>
    <a href="fells.html" class="navbox">Fells</a>
    <a href="links.html" class="navbox">Links</a>
    <a href="travel.html" class="navbox">Travel</a>
  </nav>
  <article>
    <div id="locationmap">

    </div>
    <div id="wiki">

    </div>
  </article>
  <footer></footer>
  <script type="text/javascript">
    var mymap = L.map('locationmap', {
      center: [54.459, -3.092],
      zoom: 10
    });
    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
      attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
      maxZoom: 18,
      id: 'mapbox.streets',
      accessToken: 'pk.eyJ1IjoicHI2OCIsImEiOiJjamIyMXpkZXc4dDE5MndxZW44czVhaXBkIn0.0sfaLuXhICPEABMRJjc2Pw'
    }).addTo(mymap);

    var processResponse = function(data) {
      var txt = data.query.pages[0].extract;
      txtStripped = txt.replace(/<(?:.|\n)*?>/gm, '');
      try{
        document.getElementById('wiki').textContent = txtStripped;
      }
      catch(err) {
        document.getElementById('wiki').textContent = err.message;
      }
    }

    var encodeParameters = function(params) {
      var strArray = [];
      for (var key in params) {
        if (params.hasOwnProperty(key)) {
          var paramString = encodeURIComponent(key) + '=' + encodeURIComponent(params[key]);
          strArray.push(paramString);
        }
      }
      return strArray.join('&');
    }

    var query = 'Lake District';

    var parameters = {
      format: 'json',
      formatversion: 2,
      action: 'query',
      prop: 'extracts',
      exintro: '',
      titles: query,
      redirects: '',
      callback: 'processResponse'
    }

    var base_url = 'https://en.wikipedia.org/w/api.php'
    var query_url = base_url + '?' + encodeParameters(parameters);

    console.log(query_url);

    var script = document.createElement('script')
    script.src = query_url;
    document.getElementsByTagName('head')[0].appendChild(script);
  </script>
</body>

</html>
